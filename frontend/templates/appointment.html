{% extends 'base.html' %}
{% load static %}

{% block title %}Book Appointment | Hospital Management{% endblock %}

{% block content %}
    <div class="auth-background" style="background: linear-gradient(to bottom,rgba(224, 181, 94, 0.5),rgb(228, 157, 230,0.5));";>
        <div class="login-signup-container">
            <h2 class="section-title">Book an Appointment</h2>
            {% if user.is_authenticated %}
                {% if form %}
                    <form method="post" class="login-form">
                        {% csrf_token %}
                        {% for field in form %}
                            <div class="form-group">
                                <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                                {{ field }}
                                {% if field.help_text %}
                                    <small class="form-text text-muted">{{ field.help_text }}</small>
                                {% endif %}
                                {% if field.errors %}
                                    <div class="alert alert-danger" role="alert">
                                        {{ field.errors.as_text }}
                                    </div>
                                {% endif %}
                            </div>
                        {% endfor %}
                        <button type="submit" class="btn">Book Appointment</button>
                    </form>
                {% endif %}

                {% if messages %}
                    <div class="messages">
                        {% for message in messages %}
                            <div class="alert alert-{% if message.tags == 'success' %}success{% elif message.tags == 'error' %}danger{% else %}info{% endif %}" role="alert">
                                {{ message }}
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}

                <h2>Your Appointment History</h2>
                {% if appointments %}
                    <div class="appointment-history">
                        {% for appointment in appointments %}
                            <div class="appointment-item">
                                <p><strong>Date:</strong> {{ appointment.appointment_date }}</p>
                                <p><strong>Reason:</strong> {{ appointment.reason }}</p>
                                <p><strong>Doctor:</strong> {{ appointment.doctor.name }}</p>
                            </div>
                        {% endfor %}
                    </div>
                {% else %}
                <p>No Appointments Booked Yet !!!!</p>
                 {% endif %}
            {% else %}
                <p>Please <a href="{% url 'login' %}">log in</a> to book an appointment and view your appointment history.</p>
            {% endif %}
        </div>
    </div>
    <style>
      .appointment-history {
        margin-top: 20px;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 15px;
      }
      .appointment-item{
        padding: 10px;
        border-bottom: 1px solid #eee;
      }
      .appointment-item:last-child{
        border-bottom: none;
      }
    </style>
{% endblock %}
